{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { HouseType2LabelMapping, TypeHouses } from 'src/app/accomodation/models/house.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/accomodation/services/houses.service\";\nimport * as i2 from \"src/app/accomodation/services/agency.service\";\nfunction AddHousesComponent_div_2_option_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const fileType_r4 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"value\", fileType_r4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.HouseType2LabelMapping[fileType_r4], \" \");\n  }\n}\nfunction AddHousesComponent_div_2_option_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const agency_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", agency_r5.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", agency_r5.name, \" \");\n  }\n}\nfunction AddHousesComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 2)(2, \"label\", 3);\n    i0.ɵɵtext(3, \"House type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵelementStart(5, \"select\", 4);\n    i0.ɵɵlistener(\"ngModelChange\", function AddHousesComponent_div_2_Template_select_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.house.type_houses = $event);\n    });\n    i0.ɵɵtemplate(6, AddHousesComponent_div_2_option_6_Template, 2, 2, \"option\", 5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 2)(8, \"label\", 6);\n    i0.ɵɵtext(9, \"Country\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"input\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function AddHousesComponent_div_2_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.house.country = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 2)(12, \"label\", 3);\n    i0.ɵɵtext(13, \"Region\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"input\", 8);\n    i0.ɵɵlistener(\"ngModelChange\", function AddHousesComponent_div_2_Template_input_ngModelChange_14_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.house.region = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\", 2)(16, \"label\", 3);\n    i0.ɵɵtext(17, \"Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"input\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function AddHousesComponent_div_2_Template_input_ngModelChange_18_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.house.adress = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\", 2)(20, \"label\", 3);\n    i0.ɵɵtext(21, \"Loyer\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"input\", 10);\n    i0.ɵɵlistener(\"ngModelChange\", function AddHousesComponent_div_2_Template_input_ngModelChange_22_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.house.loyer = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 2)(24, \"label\", 3);\n    i0.ɵɵtext(25, \"Nombre de chambres\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"input\", 11);\n    i0.ɵɵlistener(\"ngModelChange\", function AddHousesComponent_div_2_Template_input_ngModelChange_26_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.house.nbrOfRooms = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(27, \"div\", 2)(28, \"label\", 3);\n    i0.ɵɵtext(29, \"Agency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(30, \"br\");\n    i0.ɵɵelementStart(31, \"select\", 12);\n    i0.ɵɵlistener(\"ngModelChange\", function AddHousesComponent_div_2_Template_select_ngModelChange_31_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.house.agency = $event);\n    });\n    i0.ɵɵtemplate(32, AddHousesComponent_div_2_option_32_Template, 2, 2, \"option\", 5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(33, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function AddHousesComponent_div_2_Template_button_click_33_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.saveHouse());\n    });\n    i0.ɵɵtext(34, \"Submit\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.house.type_houses);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.Types);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.house.country);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.house.region);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.house.adress);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.house.loyer);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.house.nbrOfRooms);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.house.agency);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.agencies);\n  }\n}\nfunction AddHousesComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"h4\");\n    i0.ɵɵtext(2, \"House was submitted successfully!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function AddHousesComponent_div_3_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.newHouse());\n    });\n    i0.ɵɵtext(4, \"Add\");\n    i0.ɵɵelementEnd()();\n  }\n}\n/** Error when invalid control is dirty, touched, or submitted. */\nexport class MyErrorStateMatcher {\n  isErrorState(control, form) {\n    const isSubmitted = form && form.submitted;\n    return !!(control && control.invalid && (control.dirty || control.touched || isSubmitted));\n  }\n}\nexport class AddHousesComponent {\n  constructor(houseService, AgencyService) {\n    this.houseService = houseService;\n    this.AgencyService = AgencyService;\n    this.HouseType2LabelMapping = HouseType2LabelMapping;\n    this.Types = Object.values(TypeHouses);\n    this.house = {\n      type_houses: undefined,\n      country: '',\n      region: '',\n      adress: '',\n      loyer: 0,\n      available: true,\n      nbrOfRooms: 0,\n      agency: ''\n    };\n    this.submitted = false;\n    this.matcher = new MyErrorStateMatcher();\n    this.country = new FormControl(null, [Validators.required]);\n    this.state = new FormControl({\n      value: null,\n      disabled: true\n    }, [Validators.required]);\n    //this.countries = this.houseService.getCountries();\n    this.form = new FormGroup({\n      country: this.country,\n      state: this.state\n    });\n  }\n  ngOnInit() {\n    this.retrieveAgencies();\n    /*\r\n    this.country.valueChanges.subscribe((country) => {\r\n      this.state.reset();\r\n      this.state.disable();\r\n      if (country) {\r\n        this.states = this.houseService.getStatesByCountry(country);\r\n        this.state.enable();\r\n      }\r\n    });\r\n    */\n  }\n\n  retrieveAgencies() {\n    this.AgencyService.getAll().subscribe({\n      next: data => {\n        this.agencies = data;\n        console.log(data);\n      },\n      error: e => console.error(e)\n    });\n  }\n  saveHouse() {\n    const data = {\n      type_houses: this.house.type_houses,\n      country: this.house.country,\n      region: this.house.region,\n      adress: this.house.adress,\n      loyer: this.house.loyer,\n      available: this.house.available,\n      nbrOfRooms: this.house.nbrOfRooms,\n      agency: this.house.agency\n    };\n    console.log(data);\n    this.houseService.create(data, this.house.agency).subscribe({\n      next: res => {\n        console.log(res);\n        this.submitted = true;\n      },\n      error: e => console.error(e)\n    });\n  }\n  newHouse() {\n    this.submitted = false;\n    this.house = {\n      type_houses: undefined,\n      country: '',\n      region: '',\n      adress: '',\n      loyer: 0,\n      available: true,\n      nbrOfRooms: 0,\n      agency: ''\n    };\n  }\n}\nAddHousesComponent.ɵfac = function AddHousesComponent_Factory(t) {\n  return new (t || AddHousesComponent)(i0.ɵɵdirectiveInject(i1.HousesService), i0.ɵɵdirectiveInject(i2.AgencyService));\n};\nAddHousesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AddHousesComponent,\n  selectors: [[\"app-add-houses\"]],\n  decls: 4,\n  vars: 2,\n  consts: [[1, \"submit-form\"], [4, \"ngIf\"], [1, \"form-group\"], [\"for\", \"description\"], [\"name\", \"type_houses\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"title\"], [\"type\", \"text\", \"id\", \"title\", \"required\", \"\", \"name\", \"title\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"description\", \"required\", \"\", \"name\", \"region\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"description\", \"required\", \"\", \"name\", \"adress\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"description\", \"required\", \"\", \"name\", \"loyer\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"description\", \"required\", \"\", \"name\", \"nbrOfRooms\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"agencyName\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn\", \"btn-success\", 3, \"click\"], [3, \"value\"]],\n  template: function AddHousesComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\")(1, \"div\", 0);\n      i0.ɵɵtemplate(2, AddHousesComponent_div_2_Template, 35, 9, \"div\", 1);\n      i0.ɵɵtemplate(3, AddHousesComponent_div_3_Template, 5, 0, \"div\", 1);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !ctx.submitted);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.submitted);\n    }\n  },\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["FormControl","FormGroup","Validators","HouseType2LabelMapping","TypeHouses","i0","MyErrorStateMatcher","isErrorState","control","form","isSubmitted","submitted","invalid","dirty","touched","AddHousesComponent","constructor","houseService","AgencyService","Object","values","type_houses","undefined","country","region","adress","loyer","available","nbrOfRooms","agency","required","value","disabled","state","ngOnInit","retrieveAgencies","getAll","subscribe","next","data","agencies","console","log","error","e","saveHouse","house","create","res","newHouse","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\IHEB\\Desktop\\User-final\\pidev-vff\\front\\src\\app\\accomodation\\components\\Houses\\add-houses\\add-houses.component.ts","C:\\Users\\IHEB\\Desktop\\User-final\\pidev-vff\\front\\src\\app\\accomodation\\components\\Houses\\add-houses\\add-houses.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport {\r\n  FormControl,\r\n  FormGroup,\r\n  FormGroupDirective,\r\n  NgForm,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { ErrorStateMatcher } from '@angular/material/core';\r\nimport { Agency } from 'src/app/accomodation/models/agency.model';\r\nimport { House, HouseType2LabelMapping, TypeHouses } from 'src/app/accomodation/models/house.model';\r\nimport { HousesService } from 'src/app/accomodation/services/houses.service';\r\nimport { AgencyService } from 'src/app/accomodation/services/agency.service';\r\n\r\n\r\n\r\n/** Error when invalid control is dirty, touched, or submitted. */\r\nexport class MyErrorStateMatcher implements ErrorStateMatcher {\r\n  isErrorState(\r\n    control: FormControl | null,\r\n    form: FormGroupDirective | NgForm | null\r\n  ): boolean {\r\n    const isSubmitted = form && form.submitted;\r\n    return !!(\r\n      control &&\r\n      control.invalid &&\r\n      (control.dirty || control.touched || isSubmitted)\r\n    );\r\n  }\r\n}\r\n\r\ninterface Country {\r\n  shortName: string;\r\n  name: string;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-add-houses',\r\n  templateUrl: './add-houses.component.html',\r\n  styleUrls: ['./add-houses.component.css']\r\n})\r\nexport class AddHousesComponent {\r\n  public HouseType2LabelMapping = HouseType2LabelMapping;\r\n  public Types = Object.values(TypeHouses);\r\n\r\n  agencies?: Agency[];\r\n  house: House = {\r\n    type_houses: undefined,\r\n    country: '',\r\n    region: '',\r\n    adress: '',\r\n    loyer: 0,\r\n    available: true,\r\n    nbrOfRooms: 0,\r\n    agency: ''\r\n  };\r\n  submitted = false;\r\n\r\n\r\n  form: FormGroup;\r\n  matcher = new MyErrorStateMatcher();\r\n\r\n  countries: Country[];\r\n  states: string[];\r\n\r\n  country = new FormControl(null, [Validators.required]);\r\n  state = new FormControl({ value: null, disabled: true }, [\r\n    Validators.required,\r\n  ]);\r\n\r\n  constructor(private houseService: HousesService,private AgencyService: AgencyService) { \r\n    //this.countries = this.houseService.getCountries();\r\n    this.form = new FormGroup({\r\n      country: this.country,\r\n      state: this.state\r\n    });\r\n  }\r\n  ngOnInit(): void {\r\n    this.retrieveAgencies();\r\n    /*\r\n    this.country.valueChanges.subscribe((country) => {\r\n      this.state.reset();\r\n      this.state.disable();\r\n      if (country) {\r\n        this.states = this.houseService.getStatesByCountry(country);\r\n        this.state.enable();\r\n      }\r\n    });\r\n    */\r\n  }\r\n\r\n  retrieveAgencies(): void {\r\n    this.AgencyService.getAll()\r\n      .subscribe({\r\n        next: (data) => {\r\n          this.agencies = data;\r\n          console.log(data);\r\n        },\r\n        error: (e) => console.error(e)\r\n      });\r\n  }\r\n\r\n  saveHouse(): void {\r\n    const data = {\r\n      type_houses: this.house.type_houses,\r\n      country: this.house.country,\r\n      region: this.house.region,\r\n      adress: this.house.adress,\r\n      loyer: this.house.loyer,\r\n      available: this.house.available,\r\n      nbrOfRooms: this.house.nbrOfRooms,\r\n      agency:this.house.agency\r\n    };\r\n    console.log(data)\r\n    \r\n    this.houseService.create(data,this.house.agency)\r\n      .subscribe({\r\n        next: (res) => {\r\n          console.log(res);\r\n          this.submitted = true;\r\n        },\r\n        error: (e) => console.error(e)\r\n      });\r\n      \r\n  }\r\n\r\n  newHouse(): void {\r\n    this.submitted = false;\r\n    this.house = {\r\n    type_houses: undefined,\r\n    country: '',\r\n    region: '',\r\n    adress: '',\r\n    loyer: 0,\r\n    available: true,\r\n    nbrOfRooms: 0,\r\n    agency: ''\r\n    };\r\n  }\r\n\r\n\r\n  \r\n\r\n}","<div>\r\n    <div class=\"submit-form\">\r\n      <div *ngIf=\"!submitted\">\r\n        <div class=\"form-group\">\r\n          <label for=\"description\">House type</label><br>\r\n            <select [(ngModel)]=\"house.type_houses\" name=\"type_houses\">\r\n                <option *ngFor=\"let fileType of Types\"\r\n          [value]=\"fileType\">\r\n    {{HouseType2LabelMapping[fileType]}}\r\n  </option>\r\n            </select>\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"title\">Country</label>\r\n          <input\r\n            type=\"text\"\r\n            class=\"form-control\"\r\n            id=\"title\"\r\n            required\r\n            [(ngModel)]=\"house.country\"\r\n            name=\"title\"\r\n          />\r\n\r\n          \r\n        </div>\r\n  \r\n        <div class=\"form-group\">\r\n          <label for=\"description\">Region</label>\r\n          <input\r\n            class=\"form-control\"\r\n            id=\"description\"\r\n            required\r\n            [(ngModel)]=\"house.region\"\r\n            name=\"region\"\r\n          />\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"description\">Address</label>\r\n          <input\r\n            class=\"form-control\"\r\n            id=\"description\"\r\n            required\r\n            [(ngModel)]=\"house.adress\"\r\n            name=\"adress\"\r\n          />\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"description\">Loyer</label>\r\n          <input\r\n            class=\"form-control\"\r\n            id=\"description\"\r\n            required\r\n            [(ngModel)]=\"house.loyer\"\r\n            name=\"loyer\"\r\n          />\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"description\">Nombre de chambres</label>\r\n          <input\r\n            class=\"form-control\"\r\n            id=\"description\"\r\n            required\r\n            [(ngModel)]=\"house.nbrOfRooms\"\r\n            name=\"nbrOfRooms\"\r\n          />\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"description\">Agency</label><br>\r\n        <select [(ngModel)]=\"house.agency\" name=\"agencyName\">\r\n        <option *ngFor=\"let agency of agencies\" [value]=\"agency.id\" >\r\n            {{agency.name}}\r\n          </option>\r\n        </select>\r\n    </div>\r\n\r\n\r\n    \r\n        \r\n  \r\n        <button (click)=\"saveHouse()\" class=\"btn btn-success\">Submit</button>\r\n      </div>\r\n  \r\n      <div *ngIf=\"submitted\">\r\n        <h4>House was submitted successfully!</h4>\r\n        <button class=\"btn btn-success\" (click)=\"newHouse()\">Add</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  "]},"metadata":{},"sourceType":"module","externalDependencies":[]}